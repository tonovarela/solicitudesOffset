<div class="h-full bg-slate-50 shadow-lg font-sans rounded-lg p-5">

    <div class="w-full 3xl:w-2/5 mx-auto font-sans text-base leading-relaxed text-inherit antialiased ">


        <div class="bg-white rounded-lg  relative pt-8  shadow-dark-xl">
            <button class="absolute top-2 left-2 text-gray-500 hover:text-blue-700" (click)="regresar()">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-1" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
                <span class="hidden sm:inline text-xs">Regresar</span>
            </button>
            <div class="grid grid-cols-2 sm:grid-cols-3 p-3     sm:text-center">
                <div class="flex justify-start sm:justify-end flex-row space-x-10 ">
                    <div class="p-3 bg-purple-500 rounded-full hidden portrait:hidden sm:block ">
                        <svg class="w-9 " xmlns:dc="http://purl.org/dc/elements/1.1/"
                            xmlns:cc="http://creativecommons.org/ns#"
                            xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                            xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
                            xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" viewBox="0 0 256.00 256.00"
                            version="1.1" id="svg8" inkscape:version="0.92.3 (2405546, 2018-03-11)"
                            sodipodi:docname="gala-file-doc.svg" inkscape:export-xdpi="96" inkscape:export-ydpi="96"
                            fill="#000000">
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                            <g id="SVGRepo_iconCarrier">
                                <defs id="defs2"></defs>


                                <g inkscape:label="icon" inkscape:groupmode="layer" id="layer1">
                                    <path inkscape:connector-curvature="0" sodipodi:nodetypes="cc" id="path870"
                                        d="M 32,48 V 207.9236"
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1">
                                    </path>
                                    <path inkscape:connector-curvature="0" sodipodi:nodetypes="cc" id="path874"
                                        d="M 224,96 V 208"
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1">
                                    </path>
                                    <path inkscape:connector-curvature="0" sodipodi:nodetypes="cc" id="path880"
                                        d="m 64,16 h 80"
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1">
                                    </path>
                                    <path inkscape:connector-curvature="0" sodipodi:nodetypes="cc" id="path882"
                                        d="M 64,240 H 192"
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1">
                                    </path>
                                    <path
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1"
                                        d="m 224,208 c 0.0874,15.98169 -16,32 -32,32" id="path886"
                                        inkscape:connector-curvature="0" sodipodi:nodetypes="cc"></path>
                                    <path transform="scale(-1,1)"
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1"
                                        d="m -32,208 c -10e-7,16 -16,32 -32,32" id="path886-3"
                                        inkscape:connector-curvature="0" sodipodi:nodetypes="cc"></path>
                                    <path transform="scale(-1)"
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1"
                                        d="M -32,-47.976784 C -32,-32 -48,-16.356322 -63.999997,-16.000002"
                                        id="path886-3-6" inkscape:connector-curvature="0" sodipodi:nodetypes="cc">
                                    </path>
                                    <path inkscape:connector-curvature="0" sodipodi:nodetypes="cc" id="path933"
                                        d="M 223.91257,96.071779 144,16"
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1">
                                    </path>
                                    <path transform="scale(-1,1)"
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1"
                                        d="m -144,64 c -0.0492,15.912926 -16.06452,31.999995 -32,32" id="path886-5"
                                        inkscape:connector-curvature="0" sodipodi:nodetypes="cc"></path>
                                    <path inkscape:connector-curvature="0" id="path950" d="M 144,64 V 16"
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1"
                                        sodipodi:nodetypes="cc"></path>
                                    <path inkscape:connector-curvature="0" id="path952" d="m 176,96 h 48"
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1"
                                        sodipodi:nodetypes="cc"></path>
                                    <path
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1;stroke-miterlimit:8;stroke-dasharray:none"
                                        d="m 64,208 h 48" id="path827" inkscape:connector-curvature="0"></path>
                                    <path
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1;stroke-miterlimit:8;stroke-dasharray:none"
                                        d="m 64,176 h 80" id="path829" inkscape:connector-curvature="0"></path>
                                    <path
                                        style="fill:none;stroke:white;stroke-width:8.608;stroke-linecap:round;stroke-linejoin:round;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none"
                                        d="m 64,144 h 48" id="path831" inkscape:connector-curvature="0"></path>
                                </g>
                            </g>
                        </svg>
                    </div>
                    <div class="text-gray-900  text-center text-4xl font-semibold sm:text-2xl  ">
                        {{ SolicitudPorSurtir()?.op }}
                    </div>
                </div>

                <div class="flex flex-col text-center  w-full col-span-2 ">
                    <div class="text-gray-600 text-xl font-extrabold  ">{{ SolicitudPorSurtir()?.descripcion }}</div>
                    <div class="text-gray-800 text-lg  ">{{ SolicitudPorSurtir()?.componente }}</div>
                </div>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2   bg-slate-100/40 rounded px-9 py-3  ">
                <div class="text-gray-800 flex justify-start gap-4  "><label
                        class="text-lg font-semibold">Cantidad</label> {{

                    (SolicitudPorSurtir()!.cantidad - SolicitudPorSurtir()!.cantidadSurtida || 0) | number }}
                </div>
                <div class="text-gray-800 flex justify-start gap-4"><label
                        class="text-lg font-semibold">Solicita</label> {{
                    SolicitudPorSurtir()?.solicitante }}</div>
                <div class="text-gray-800 flex justify-start gap-4  "><label
                        class="text-lg font-semibold">MÃ¡quina</label> {{
                    SolicitudPorSurtir()?.maquina }}</div>
                <div class="text-gray-800 flex justify-start gap-4 "><label
                        class="text-lg font-semibold">Entrega</label> {{
                    SolicitudPorSurtir()?.fecha_entrega | date:'dd-MM-yyyy hh:mm' }} horas</div>
            </div>

        </div>
        @if(SolicitudPorSurtir()?.id_estado != 1){
        <div class="text-center w-full rounded-sm mt-2" [class.bg-pink-500]="SolicitudPorSurtir()?.id_estado! ==3"
            [class.bg-gray-500]="SolicitudPorSurtir()?.id_estado! ==2">
            <h1 class="text-white font-sans">{{SolicitudPorSurtir()?.estado}}</h1>
            @if(SolicitudPorSurtir()?.motivoCancelacion){
            <div class="text-start w-full  rounded-sm  border font-sans text-pretty text-gray-700 bg-white p-5">
                <b>Motivo: </b>{{SolicitudPorSurtir()?.motivoCancelacion}}
            </div>
            }
        </div>
        }



        @if(!firmar() && SolicitudPorSurtir()?.id_estado! == 1){
        <div
            class="w-full flex flex-col  sm:flex-row shadow-dark-xl  justify-between mt-5  p-5 gap-2   h-15  has-error">
            <p-inputNumber placeholder="Cantidad a surtir" size="100" inputStyleClass='w-full sm:w-48      
                  h-10                              
                   px-3 py-2 text-center text-lg   font-semibold' [(ngModel)]="cantidadSurtir"
                [disabled]="SolicitudPorSurtir()?.id_estado != 1" mode="decimal" [min]="0" [max]="MaxPorSurtir()" />
        
                <label class="text-gray-500 text-sm font-semibold self-center">Puedes surtir  {{MaxPorSurtir() | number}} piezas</label>                        
            <button class="bg-green-500 text-white text-lg font-semibold px-3 py-2 rounded-lg  w-full sm:w-48
                   disabled:cursor-not-allowed disabled:bg-gray-300 disabled:text-gray-500"
                [disabled]="cantidadSurtir <= 0 || cantidadSurtir > MaxPorSurtir()" (click)="surtir()">Surtir</button>
        </div>
        }

    </div>

    @if (firmar()){
    <div class="p-5   w-full 3xl:w-2/5 mx-auto bg-white rounded-lg shadow-dark-xl  mt-5 fade-in">
        <div class="w-full flex flex-row  justify-center  p-5 gap-2   h-15 relative">
            <button (click)="modificarCantidad()" class="absolute top-2 left-2 text-gray-500 hover:text-blue-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-1" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-7M18.5 2.5a2.121 2.121 0 1 1 3 3L12 15.5l-4 1 1-4 9.5-9.5z" />
                </svg>
                <span class="hidden sm:inline text-xs">Modificar cantidad</span>
            </button>

            <label class="text-3xl text-black font-semibold self-center">{{cantidadSurtir | number}} piezas</label>

        </div>
        <app-firma-pad (onGuardarFirma)="guardaFirma($event)" [habilitarBotones]="!estaRegistrando()"></app-firma-pad>
    </div>
    }
</div>

